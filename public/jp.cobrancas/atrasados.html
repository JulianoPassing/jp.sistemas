<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Cobranças Atrasadas - JP Cobranças</title>
  <link rel="icon" type="image/png" href="https://i.imgur.com/6N82fk2.png">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="./css/style.css">
</head>
<body class="app-layout">
<script>
fetch('/api/cobrancas/session', {
  method: 'GET',
  credentials: 'include'
})
  .then(res => { if (!res.ok) throw new Error(); return res.json(); })
  .then(data => { if (!data.authenticated) window.location.href = 'login.html'; })
  .catch(() => window.location.href = 'login.html');
</script>
  <header>
    <div class="header-content">
      <a href="dashboard.html" class="logo" style="display: flex; align-items: center;">
        <img src="https://i.imgur.com/2jT2EPD.png" alt="JP-Cobranças" style="height: 5rem; width: auto; object-fit: contain;">
      </a>
      
      <nav>
        <a href="dashboard.html" class="nav-link">
          <svg class="card-icon" fill="currentColor" viewBox="0 0 24 24">
            <path fill-rule="evenodd" d="M11.293 3.293a1 1 0 0 1 1.414 0l6 6 2 2a1 1 0 0 1-1.414 1.414L19 12.414V19a2 2 0 0 1-2 2h-3a1 1 0 0 1-1-1v-3h-2v3a1 1 0 0 1-1 1H7a2 2 0 0 1-2-2v-6.586l-.293.293a1 1 0 0 1-1.414-1.414l2-2 6-6Z" clip-rule="evenodd"></path>
          </svg>
          Dashboard
        </a>
        <a href="clientes.html" class="nav-link">
          <svg class="card-icon" fill="currentColor" viewBox="0 0 24 24">
            <path fill-rule="evenodd" d="M8 4a4 4 0 1 0 0 8 4 4 0 0 0 0-8Zm-2 9a4 4 0 0 0-4 4v1a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2v-1a4 4 0 0 0-4-4H6Zm7.25-2.095c.478-.86.75-1.85.75-2.905a5.973 5.973 0 0 0-.75-2.906 4 4 0 1 1 0 5.811ZM15.466 20c.34-.588.535-1.271.535-2v-1a5.978 5.978 0 0 0-1.528-4H18a4 4 0 0 1 4 4v1a2 2 0 0 1-2 2h-4.535Z" clip-rule="evenodd"></path>
          </svg>
          Clientes
        </a>
        <a href="emprestimos.html" class="nav-link">
          <svg class="card-icon" fill="currentColor" viewBox="0 0 24 24">
            <path fill-rule="evenodd" d="M15 4H9v16h6V4Zm2 16h3a2 2 0 0 0 2-2V6a2 2 0 0 0-2-2h-3v16ZM4 4h3v16H4a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2Z" clip-rule="evenodd"></path>
          </svg>
          Empréstimos
        </a>
        <a href="cobrancas.html" class="nav-link">
          <svg class="card-icon" fill="currentColor" viewBox="0 0 24 24">
            <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 17.345a4.76 4.76 0 0 0 2.558 1.618c2.274.589 4.512-.446 4.999-2.31.487-1.866-1.273-3.9-3.546-4.49-2.273-.59-4.034-2.623-3.547-4.488.486-1.865 2.724-2.899 4.998-2.31.982.236 1.87.793 2.538 1.592m-3.879 12.171V21m0-18v2.2"></path>
          </svg>
          Cobranças
        </a>
        <a href="atrasados.html" class="nav-link active">
          <svg class="card-icon" fill="currentColor" viewBox="0 0 24 24">
            <path fill-rule="evenodd" d="M6 5V4a1 1 0 1 1 2 0v1h3V4a1 1 0 1 1 2 0v1h3V4a1 1 0 1 1 2 0v1h1a2 2 0 0 1 2 2v2H3V7a2 2 0 0 1 2-2h1ZM3 19v-8h18v8a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2Zm5-6a1 1 0 1 0 0 2h8a1 1 0 1 0 0-2H8Z" clip-rule="evenodd"></path>
          </svg>
          Atrasados
        </a>
      </nav>
      
      <button class="menu-toggle" id="menuToggle">
        <svg fill="currentColor" viewBox="0 0 24 24" width="24" height="24">
          <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
        </svg>
      </button>
    </div>
  </header>

  <main>
    <div class="container">
      <!-- Header da página -->
      <div class="dashboard-header">
        <div class="dashboard-title">Gestão de Atrasados</div>
        <div class="dashboard-subtitle">Acompanhe e gerencie os pagamentos em atraso</div>
      </div>

      <!-- Cards de estatísticas -->
      <div class="cards">
        <div class="card fade-in">
          <div class="card-header">
            <div class="card-title">Total em Atraso</div>
            <svg class="card-icon" fill="currentColor" viewBox="0 0 24 24">
              <path fill-rule="evenodd" d="M6 5V4a1 1 0 1 1 2 0v1h3V4a1 1 0 1 1 2 0v1h3V4a1 1 0 1 1 2 0v1h1a2 2 0 0 1 2 2v2H3V7a2 2 0 0 1 2-2h1ZM3 19v-8h18v8a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2Zm5-6a1 1 0 1 0 0 2h8a1 1 0 1 0 0-2H8Z" clip-rule="evenodd"></path>
            </svg>
          </div>
          <div class="card-value" id="total-atraso">0</div>
          <div class="card-change negative">
            <svg width="16" height="16" fill="currentColor" viewBox="0 0 24 24">
              <path fill-rule="evenodd" d="M12 20.25a.75.75 0 01-.75-.75V6.31l-6.22 6.22a.75.75 0 11-1.06-1.06l7.5-7.5a.75.75 0 011.06 0l7.5 7.5a.75.75 0 11-1.06 1.06l-6.22-6.22V19.5a.75.75 0 01-.75.75z" clip-rule="evenodd"></path>
            </svg>
            +5 este mês
          </div>
        </div>

        <div class="card fade-in">
          <div class="card-header">
            <div class="card-title">Valor em Atraso</div>
            <svg class="card-icon" fill="currentColor" viewBox="0 0 24 24">
              <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 17.345a4.76 4.76 0 0 0 2.558 1.618c2.274.589 4.512-.446 4.999-2.31.487-1.866-1.273-3.9-3.546-4.49-2.273-.59-4.034-2.623-3.547-4.488.486-1.865 2.724-2.899 4.998-2.31.982.236 1.87.793 2.538 1.592m-3.879 12.171V21m0-18v2.2"></path>
            </svg>
          </div>
          <div class="card-value" id="valor-atraso">R$ 0,00</div>
          <div class="card-change negative">
            <svg width="16" height="16" fill="currentColor" viewBox="0 0 24 24">
              <path fill-rule="evenodd" d="M12 20.25a.75.75 0 01-.75-.75V6.31l-6.22 6.22a.75.75 0 11-1.06-1.06l7.5-7.5a.75.75 0 011.06 0l7.5 7.5a.75.75 0 11-1.06 1.06l-6.22-6.22V19.5a.75.75 0 01-.75.75z" clip-rule="evenodd"></path>
            </svg>
            +12% este mês
          </div>
        </div>

        <div class="card fade-in">
          <div class="card-header">
            <div class="card-title">Atraso Crítico (>30 dias)</div>
            <svg class="card-icon" fill="currentColor" viewBox="0 0 24 24">
              <path fill-rule="evenodd" d="M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z" clip-rule="evenodd"></path>
            </svg>
          </div>
          <div class="card-value" id="atraso-critico">0</div>
          <div class="card-change negative">
            <svg width="16" height="16" fill="currentColor" viewBox="0 0 24 24">
              <path fill-rule="evenodd" d="M12 20.25a.75.75 0 01-.75-.75V6.31l-6.22 6.22a.75.75 0 11-1.06-1.06l7.5-7.5a.75.75 0 011.06 0l7.5 7.5a.75.75 0 11-1.06 1.06l-6.22-6.22V19.5a.75.75 0 01-.75.75z" clip-rule="evenodd"></path>
            </svg>
            +3 este mês
          </div>
        </div>

        <div class="card fade-in">
          <div class="card-header">
            <div class="card-title">Recuperados Hoje</div>
            <svg class="card-icon" fill="currentColor" viewBox="0 0 24 24">
              <path fill-rule="evenodd" d="M12 2.25c-5.385 0-9.75 4.365-9.75 9.75s4.365 9.75 9.75 9.75 9.75-4.365 9.75-9.75S17.385 2.25 12 2.25zm-2.625 6c-.54 0-1.062.248-1.431.659l-1.591 1.85c-.465.54-.465 1.342 0 1.882l1.591 1.85c.369.411.891.659 1.431.659.54 0 1.062-.248 1.431-.659l1.591-1.85c.465-.54.465-1.342 0-1.882l-1.591-1.85c-.369-.411-.891-.659-1.431-.659z" clip-rule="evenodd"></path>
            </svg>
          </div>
          <div class="card-value" id="recuperados-hoje">0</div>
          <div class="card-change positive">
            <svg width="16" height="16" fill="currentColor" viewBox="0 0 24 24">
              <path fill-rule="evenodd" d="M12 3.75a.75.75 0 01.75.75v13.19l6.22-6.22a.75.75 0 111.06 1.06l-7.5 7.5a.75.75 0 01-1.06 0l-7.5-7.5a.75.75 0 111.06-1.06l6.22 6.22V4.5a.75.75 0 01.75-.75z" clip-rule="evenodd"></path>
            </svg>
            +8 hoje
          </div>
        </div>
      </div>

      <!-- Seção de Lista de Atrasados -->
      <div class="section">
        <div class="section-header">
          <h3 class="section-title">Lista de Atrasados</h3>
          <div class="flex gap-2">
            <select id="filterAtraso" class="form-input" style="width: 150px;">
              <option value="">Todos os atrasos</option>
              <option value="1-7">1-7 dias</option>
              <option value="8-15">8-15 dias</option>
              <option value="16-30">16-30 dias</option>
              <option value="30+">+30 dias</option>
            </select>
            <input type="text" id="searchAtrasado" class="form-input" placeholder="Buscar..." style="width: 200px;">
            <button class="btn btn-warning" id="enviarLembretes">
              <svg width="16" height="16" fill="currentColor" viewBox="0 0 24 24">
                <path fill-rule="evenodd" d="M12 3.75a.75.75 0 01.75.75v6.75h6.75a.75.75 0 010 1.5h-6.75v6.75a.75.75 0 01-1.5 0v-6.75H4.5a.75.75 0 010-1.5h6.75V4.5a.75.75 0 01.75-.75z" clip-rule="evenodd"></path>
              </svg>
              Enviar Lembretes
            </button>
            <button class="btn btn-secondary" id="exportAtrasados">
              <svg width="16" height="16" fill="currentColor" viewBox="0 0 24 24">
                <path fill-rule="evenodd" d="M12 3.75a.75.75 0 01.75.75v6.75h6.75a.75.75 0 010 1.5h-6.75v6.75a.75.75 0 01-1.5 0v-6.75H4.5a.75.75 0 010-1.5h6.75V4.5a.75.75 0 01.75-.75z" clip-rule="evenodd"></path>
              </svg>
              Exportar
            </button>
          </div>
        </div>
        
        <div class="table-container">
          <table class="table">
            <thead>
              <tr>
                <th>Cliente</th>
                <th>Empréstimo</th>
                <th>Parcela</th>
                <th>Valor</th>
                <th>Vencimento</th>
                <th>Dias Atraso</th>
                <th>Status</th>
                <th>Ações</th>
              </tr>
            </thead>
            <tbody id="atrasados-lista">
              <tr>
                <td colspan="8" class="text-center text-gray-500">Carregando...</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <!-- Seção de Ações em Massa -->
      <div class="section">
        <div class="section-header">
          <h3 class="section-title">Ações em Massa</h3>
        </div>
        
        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
          <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4">
            <h4 class="font-semibold text-yellow-800 mb-2">Lembretes Automáticos</h4>
            <p class="text-sm text-yellow-700 mb-3">Envie lembretes para todos os atrasados</p>
            <button class="btn btn-warning w-full">
              <svg width="16" height="16" fill="currentColor" viewBox="0 0 24 24">
                <path fill-rule="evenodd" d="M12 3.75a.75.75 0 01.75.75v6.75h6.75a.75.75 0 010 1.5h-6.75v6.75a.75.75 0 01-1.5 0v-6.75H4.5a.75.75 0 010-1.5h6.75V4.5a.75.75 0 01.75-.75z" clip-rule="evenodd"></path>
              </svg>
              Enviar Lembretes
            </button>
          </div>
          
          <div class="bg-red-50 border border-red-200 rounded-lg p-4">
            <h4 class="font-semibold text-red-800 mb-2">Cobrança Judicial</h4>
            <p class="text-sm text-red-700 mb-3">Iniciar processo para atrasos críticos</p>
            <button class="btn btn-danger w-full">
              <svg width="16" height="16" fill="currentColor" viewBox="0 0 24 24">
                <path fill-rule="evenodd" d="M12 3.75a.75.75 0 01.75.75v6.75h6.75a.75.75 0 010 1.5h-6.75v6.75a.75.75 0 01-1.5 0v-6.75H4.5a.75.75 0 010-1.5h6.75V4.5a.75.75 0 01.75-.75z" clip-rule="evenodd"></path>
              </svg>
              Iniciar Processo
            </button>
          </div>
          
          <div class="bg-green-50 border border-green-200 rounded-lg p-4">
            <h4 class="font-semibold text-green-800 mb-2">Relatório de Atrasos</h4>
            <p class="text-sm text-green-700 mb-3">Gerar relatório detalhado</p>
            <button class="btn btn-primary w-full">
              <svg width="16" height="16" fill="currentColor" viewBox="0 0 24 24">
                <path fill-rule="evenodd" d="M12 3.75a.75.75 0 01.75.75v6.75h6.75a.75.75 0 010 1.5h-6.75v6.75a.75.75 0 01-1.5 0v-6.75H4.5a.75.75 0 010-1.5h6.75V4.5a.75.75 0 01.75-.75z" clip-rule="evenodd"></path>
              </svg>
              Gerar Relatório
            </button>
          </div>
        </div>
      </div>
    </div>
  </main>

  <footer>
    <p>&copy; 2025 JP. Sistemas. Todos os direitos reservados. | jp-sistemas.com</p>
  </footer>

  <script src="./js/main.js"></script>
  <script src="./js/atrasados.js"></script>
</body>
</html> 